(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6234],{78582:function(e,t,r){"use strict";var n=r(15311),a=r(1239),o=r(69884),i=r(6481),s=r(64817),l=r(20132);t.Z=e=>{let{error:t}=e,{t:r}=(0,s.Z)(),{selectedChainId:c}=(0,a.JM)();(0,l.useEffect)(()=>{console.log(t)},[]);let u=r("common:errors.messages.chain_could_not_connect",{chainName:(0,o.qz)(c)}),d=(0,i.O1)(t),m=(0,i.eE)(d)?u:d;return(0,n.jsxs)("div",{children:["Error: ",m]})}},69550:function(e,t,r){"use strict";var n=r(15311),a=r(92793),o=r(78582);t.Z=e=>{let{isLoading:t,error:r,children:i,loadingChildren:s,className:l,loadingMessage:c}=e,u={container:(0,a.m6)("animate-pulse bg-zinc-300 dark:bg-zinc-700 rounded-lg",l),border:(0,a.m6)("absolute inset-0 border border-zinc-400 dark:border-zinc-500 rounded-lg animate-pulse",l),message:"absolute inset-0 flex justify-center items-center"};return r?(0,n.jsx)(o.Z,{error:r}):t?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:u.container,children:(0,n.jsx)("div",{className:"invisible",children:s||i})}),(0,n.jsx)("div",{className:u.border}),(0,n.jsx)("div",{className:u.message,children:c})]}):(0,n.jsx)(n.Fragment,{children:i})}},7930:function(e,t,r){"use strict";var n=r(14785);class a extends n.ZP{async getBlockTimestamp(e,t){try{let r=e.chain.id,n=await this.blocks.get([r,t]);if(n)return n.timestamp;let a=await e.getBlock({blockNumber:BigInt(t)}),o=Number(null==a?void 0:a.timestamp);return await this.blocks.put({chainId:r,blockNumber:t,timestamp:o}),o}catch(r){if(r instanceof n.ZP.DexieError){let r=await e.getBlock({blockNumber:BigInt(t)});return Number(null==r?void 0:r.timestamp)}throw r}}async getLogTimestamp(e,t){var r;return null!==(r=t.timestamp)&&void 0!==r?r:this.getBlockTimestamp(e,t.blockNumber)}constructor(){super("Blocks"),this.version(20230314).stores({blocks:"[chainId+blockNumber], timestamp"})}}let o=new a;t.Z=o},53266:function(e,t,r){"use strict";var n=r(64381),a=r(14785),o=r(69884);let i=[n.a_.PulseChain,n.a_.BitTorrentChainMainnet,n.a_.SmartBitcoinCash,n.a_.RedlightChainMainnet];class s extends a.ZP{async getLogs(e,t,r){return await this.getLogsInternal(e,t,r)}async getLogsInternal(e,t,r){let n=(0,o.JQ)(r)?Math.max(t.toBlock-50,0):t.toBlock;if(i.includes(r))return e.getLogs({...t,toBlock:n});try{let{address:a,topics:o}=t,i=o.join(",")+(a?"/".concat(a):""),s=await this.events.get([r,i]),l=(null==s?void 0:s.toBlock)?s.toBlock+1:t.fromBlock;if(l>n)return s.logs.filter(e=>e.blockNumber>=t.fromBlock&&e.blockNumber<=t.toBlock);let c=await e.getLogs({...t,fromBlock:l,toBlock:n}),u=[...(null==s?void 0:s.logs)||[],...c];return await this.events.put({chainId:r,address:a,topicsKey:i,topics:o,toBlock:n,logs:u}),u}catch(r){if(console.error(r),r instanceof a.ZP.DexieError)return e.getLogs(t);throw r}}constructor(){super("Events"),this.version(20230314).stores({events:"[chainId+topicsKey], topics, toBlock"}),this.version(20230410.1).stores({events:"[chainId+topicsKey], chainId, topics, toBlock"}),this.version(20230410.2).upgrade(e=>{e.table("events").where("chainId").anyOf([16666e5,4689,9001,71402,288,592,336]).modify(e=>{e.toBlock-=50})})}}let l=new s;t.Z=l},46631:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var n=r(75647),a=r(96815),o=r(96932);let i=e=>{let{data:t,isLoading:r}=(0,n.a)({queryKey:["openSeaProxyAddress",e,{persist:!0}],queryFn:()=>(0,o.v1)(e),enabled:!!e,gcTime:7*a.x4,staleTime:5*a.x4});return{openSeaProxyAddress:t,isLoading:r}}},1239:function(e,t,r){"use strict";r.d(t,{aN:function(){return F},RG:function(){return S},OS:function(){return O},JM:function(){return A}});var n=r(15311),a=r(69884),o=r(5762),i=r(20132),s=r(7336),l=r.n(s),c=r(76510),u=r(26294),d=r(66685),m=r(93671),v=r(12662),p=r(55961),f=r(75647),h=r(96815),g=r(87831);let w=e=>(0,f.a)({queryKey:["blockNumber",e],queryFn:async()=>(0,g.RQ)({chainId:e}).then(Number),gcTime:1*h.EB,staleTime:1*h.EB});var y=r(53266),b=r(83176),k=r(75238);let L=()=>{let{data:e,isLoading:t,error:r}=(0,f.a)({queryKey:["login"],queryFn:()=>k.Z.post("/api/login").json().then(e=>!!(null==e?void 0:e.ok)),staleTime:12*h.kr,refetchOnWindowFocus:!0,refetchOnReconnect:!0,refetchOnMount:!0,retry:5});return{isLoggedIn:e,loggingIn:t,error:r}},x=(e,t,r)=>{let{isLoggedIn:n,loggingIn:a,error:o}=L(),s=(0,f.a)({queryKey:["logs",r,t,n],queryFn:async()=>y.Z.getLogs((0,b.nm)(t),r,t),refetchOnWindowFocus:!1,staleTime:1/0,enabled:!!t&&!!n&&![null==r?void 0:r.fromBlock,null==r?void 0:r.toBlock,null==r?void 0:r.topics].includes(void 0)});(0,i.useEffect)(()=>{s.data&&console.log("".concat(e," events"),s.data)},[s.data]);let l=o?Error("Failed to create API session"):s.error;return{...s,isLoading:s.isLoading||a,error:l}},C=(e,t,r)=>{let{data:n,isLoading:a,error:o}=w(t),i=x(e,t,{...r,fromBlock:0,toBlock:n});return{...i,isLoading:i.isLoading||a,error:i.error||o}};var B=r(46631),N=r(41819);let I=(e,t)=>{let r=e=>(0,v.e)((0,p.mE)({abi:u.f4,name:e})),n=e?(0,d.p1)(e):void 0,a=n&&[r("Approval"),n],o=n&&[r("Permit"),n],s=n&&[r("Lockdown"),n],{data:l,isLoading:c,error:m}=C("Permit2 Approval",t,{address:N.Ld,topics:a}),{data:f,isLoading:h,error:g}=C("Permit2 Permit",t,{address:N.Ld,topics:o}),{data:w,isLoading:y,error:b}=C("Permit2 Lockdown",t,{address:N.Ld,topics:s}),k=h||c||y,L=g||m||b;return{events:(0,i.useMemo)(()=>{if(f&&l&&w&&!L&&!k)return[...l,...f,...w]},[f,l,w]),isLoading:k,error:L}},E=(e,t)=>{let{openSeaProxyAddress:r,isLoading:n}=(0,B.C)(e),a=e=>(0,v.e)((0,p.mE)({abi:u.xG,name:e})),o=e?(0,d.p1)(e):void 0,s=o&&[a("Transfer"),null,o],l=o&&[a("Transfer"),o],c=o&&[a("Approval"),o],f=o&&[a("ApprovalForAll"),o],{data:h,isLoading:g,error:w}=C("Transfer (to)",t,{topics:s}),{data:y,isLoading:b,error:k}=C("Transfer (from)",t,{topics:l}),{data:L,isLoading:x,error:N}=C("Approval",t,{topics:c}),{data:E,isLoading:q,error:T}=C("ApprovalForAll",t,{topics:f}),{events:P,isLoading:j,error:_}=I(e,t),F=(0,i.useMemo)(()=>{if(y&&h&&L&&E)return[...E,...(0,m.bk)(e,r,[...L,...E,...y,...h])]},[y,h,L,E,r]),A=n||b||g||x||q||j,O=k||w||N||T||_;return{events:(0,i.useMemo)(()=>{if(y&&h&&L&&F&&P&&!O&&!A)return{transferFrom:y,transferTo:h,approval:L,approvalForAll:F,permit2Approval:P}},[y,h,L,F,P]),isLoading:A,error:O}};var q=r(54329),T=r(83968),P=r(47495);let j=(e,t,r)=>{let[n,a]=(0,i.useState)(),o=(0,c.t_)({chainId:r}),{data:s,isLoading:l,error:u}=(0,f.a)({queryKey:["allowances",e,r,t],queryFn:async()=>{let n=(0,m.pV)(e,t,o,r);return(0,q.j)("Fetched Allowances",{account:e,chainId:r}),n},staleTime:1/0,enabled:!!e&&!!r&&!!t});(0,i.useLayoutEffect)(()=>{s&&a(s)},[s]);let d=(e,t)=>e.contract.address===t.contract.address&&e.chainId===t.chainId,v=(e,t)=>d(e,t)&&e.spender===t.spender&&e.tokenId===t.tokenId,p=e=>{a(t=>{let r=t.filter(t=>!v(t,e)),n=!(0,T.xk)(e.balance,e.metadata.decimals),a=!r.find(t=>d(t,e));return n&&a&&r.push((0,m.Sf)(e)),r})};return{allowances:n,isLoading:l,error:u,onUpdate:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(await P.E.invalidateQueries({queryKey:["blockNumber",r],refetchType:"none"}),await P.E.invalidateQueries({queryKey:["walletHealthScore",r,e.owner],refetchType:"none"}),!t.amount||0n===t.amount)return p(e);a(r=>r.map(r=>v(r,e)?{...r,...t}:r))}}},_=i.createContext({}),F=e=>{let{children:t,address:r,initialChainId:s}=e,u=(0,o.useRouter)(),{chain:d}=(0,c.LN)(),m=[s,parseInt(u.query.chainId),null==d?void 0:d.id,1].find(e=>(0,a.EC)(e)),[v,p]=(0,i.useState)(m);(0,i.useEffect)(()=>{u.query.chainId||u.replace({query:{...u.query,chainId:v}})},[u.query.chainId]),(0,i.useEffect)(()=>{v&&u.replace({query:{...u.query,chainId:v}})},[v]);let f=E(r,v),h=j(r,null==f?void 0:f.events,v);h.error=(null==h?void 0:h.error)||(null==f?void 0:f.error),h.isLoading=((null==h?void 0:h.isLoading)||(null==f?void 0:f.isLoading)||!(null==h?void 0:h.allowances))&&!(null==h?void 0:h.error);let[g,w]=l()("signature-notice-acknowledged",!1);return(0,n.jsx)(_.Provider,{value:{address:r,selectedChainId:v,selectChain:p,eventContext:f,allowanceContext:h,signatureNoticeAcknowledged:g,acknowledgeSignatureNotice:()=>w(!0)},children:t})},A=()=>(0,i.useContext)(_),O=()=>(0,i.useContext)(_).eventContext,S=()=>(0,i.useContext)(_).allowanceContext},50865:function(e,t,r){"use strict";r.d(t,{x:function(){return n}});let n={titleTemplate:"%s | Revoke.cash",openGraph:{url:"https://revoke.cash/",images:[{url:"https://revoke.cash/assets/images/revoke-og-image.jpg",width:1600,height:900}],site_name:"Revoke.cash",type:"website"},twitter:{handle:"@RoscoKalis",site:"@RevokeCash",cardType:"summary_large_image"},additionalLinkTags:[{rel:"icon",type:"image/x-icon",href:"/favicon.ico"},{rel:"apple-touch-icon",href:"/assets/images/apple-touch-icon.png"},{rel:"manifest",href:"/manifest.json"}],additionalMetaTags:[{name:"theme-color",content:"#000000"}]}},83176:function(e,t,r){"use strict";r.d(t,{nm:function(){return h}});var n=r(75238),a=r(49656),o=r(95677),i=r(89541),s=r(87474),l=r(48523);class c{async add(e){if(this.upstashQueue&&"p-queue"!==this.preferredQueue){var t;let{success:r}=await this.upstashQueue.blockUntilReady(this.identifier,null!==(t=this.rateLimit.timeout)&&void 0!==t?t:1e4);if(!r)throw Error("Queued request timed out");return e()}return this.pQueue.add(e,{throwOnTimeout:!0})}constructor(e,t,r){this.identifier=e,this.rateLimit=t,this.preferredQueue=r,this.pQueue=new s.Z(t),this.upstashQueue=l.env.UPSTASH_REDIS_REST_URL&&new o.Ratelimit({redis:i.s.fromEnv(),limiter:o.Ratelimit.slidingWindow(t.intervalCap,"".concat(t.interval," ms"))})}}var u=r(69884),d=r(6481);class m{async getLogs(e){try{return await this.underlyingProvider.getLogs(e)}catch(i){if(!(0,d.nI)((0,d.O1)(i))||e.fromBlock===e.toBlock)throw i;let t=e.fromBlock+Math.floor((e.toBlock-e.fromBlock)/2),r=this.getLogs({...e,toBlock:t}),n=this.getLogs({...e,fromBlock:t+1}),[a,o]=await Promise.all([r,n]);return[...a,...o]}}constructor(e){this.underlyingProvider=e}}class v{async getLogs(e){try{return await this.queue.add(()=>n.Z.post("/api/".concat(this.chainId,"/logs"),{json:e,timeout:!1}).json())}catch(e){var t,r;throw Error(null!==(r=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)&&void 0!==r?r:null==e?void 0:e.message)}}constructor(e){this.chainId=e,this.queue=new c(String(e),{interval:200,intervalCap:1},"p-queue")}}class p{async getLogs(e){return(await this.client.request({method:"eth_getLogs",params:[{...e,fromBlock:"0x".concat(e.fromBlock.toString(16)),toBlock:"0x".concat(e.toBlock.toString(16))}]})).map(e=>this.formatEvent(e))}formatEvent(e){return{...e,address:(0,a.K)(e.address.replace("xdc","0x").replace("00x","0x00")),blockNumber:Number(e.blockNumber),logIndex:Number(e.logIndex),transactionIndex:Number(e.transactionIndex)}}constructor(e,t){this.chainId=e,this.client=(0,u.AP)(e,null!=t?t:(0,u.qe)(e))}}let f=(e,t)=>(0,u.d_)(e)?new v(e):new p(e,t),h=(e,t)=>new m(f(e,t))},93671:function(e,t,r){"use strict";r.d(t,{Sf:function(){return C},XQ:function(){return k},bk:function(){return x},hp:function(){return L},j3:function(){return B},pV:function(){return v},y$:function(){return I}});var n=r(63077),a=r(7930),o=r(75238),i=r(22436),s=r(12662),l=r(66685),c=r(6481),u=r(57826),d=r(41819),m=r(83968);let v=async(e,t,r,n)=>{let a=[...t.approvalForAll,...t.approval,...t.transferTo],o=(0,m.E0)(a,r);return(await Promise.all(o.map(async r=>{let a=(0,l.tO)(t.approvalForAll,r.address),o=(0,l.tO)(t.approval,r.address),i=(0,l.tO)(t.transferFrom,r.address),s=(0,l.tO)(t.transferTo,r.address),u=[null,null,(0,l.p1)(r.address)],d=(0,l.tE)(t.permit2Approval,u);try{let t=await (0,m.wl)(r,e,i,s,n),l=await p(r,o,a,d,e,t);if(0===l.length)return[t];return l.map(e=>({...t,...e}))}catch(e){var v;if((0,c.eE)((0,c.O1)(e))||(null===(v=(0,c.O1)(e))||void 0===v?void 0:v.includes("Cannot decode zero data")))throw e;return[]}}))).flat().filter(e=>e.spender||"ERC1155"!==e.balance).filter(e=>e.spender||!(0,m.xk)(e.balance,e.metadata.decimals)).sort((e,t)=>e.metadata.symbol.localeCompare(t.metadata.symbol))},p=async(e,t,r,n,a,o)=>{if((0,m.RM)(e)){let n=await y(e,a,r);return[...await g(e,t),...n].filter(e=>!!e)}return[...await f(e,a,t),...await (0,d.VJ)(e,a,n)].filter(e=>!N(e,o))},f=async(e,t,r)=>{let n=(0,l.O1)(r).reverse(),a=(0,l.Fv)(n);return await Promise.all(a.map(r=>h(e,t,r)))},h=async(e,t,r)=>{let n=(0,l.xM)(r.topics[2]);if(0n===(0,i.H_)(r.data,"bigint"))return{spender:n,amount:0n,lastUpdated:0,transactionHash:r.transactionHash};let[o,s,c]=await Promise.all([e.publicClient.readContract({...e,functionName:"allowance",args:[t,n]}),a.Z.getLogTimestamp(e.publicClient,r),r.transactionHash]);return{spender:n,amount:o,lastUpdated:s,transactionHash:c}},g=async(e,t)=>{let r=(0,l.O1)(t).reverse(),n=(0,l.Fv)(r);return await Promise.all(n.map(t=>w(e,t)))},w=async(e,t)=>{try{let r=4===t.topics.length?t.topics[3]:t.data,o=(0,i.H_)(r,"bigint");if((0,l.xM)(t.topics[2])===n.je)return;let[s,c,u,d]=await Promise.all([e.publicClient.readContract({...e,functionName:"ownerOf",args:[o]}),e.publicClient.readContract({...e,functionName:"getApproved",args:[o]}),a.Z.getLogTimestamp(e.publicClient,t),t.transactionHash]),m=(0,l.xM)(t.topics[1]);if(c===n.je||s!==m)return;return{spender:c,tokenId:o,lastUpdated:u,transactionHash:d}}catch(e){return}},y=async(e,t,r)=>{let n=(0,l.O1)(r).reverse(),a=(0,l.Fv)(n);return await Promise.all(a.map(r=>b(e,t,r)))},b=async(e,t,r)=>{let n=(0,l.xM)(r.topics[2]);if(!("0x"!==r.data&&0n!==(0,i.H_)(r.data,"bigint")))return;let[o,s]=await Promise.all([a.Z.getLogTimestamp(e.publicClient,r),r.transactionHash]);return{spender:n,lastUpdated:o,transactionHash:s}},k=(e,t,r)=>e>r?"Unlimited":(0,u.bc)(e,t),L=e=>{if(!e.spender)return{i18nKey:"address:allowances.none"};if(e.amount){let t=k(e.amount,e.metadata.decimals,e.metadata.totalSupply),{symbol:r}=e.metadata;return{amount:t,i18nKey:"Unlimited"===t?"address:allowances.unlimited":"address:allowances.amount",symbol:r}}let t=void 0===e.tokenId?"address:allowances.unlimited":"address:allowances.token_id",{tokenId:r}=e;return{tokenId:r,i18nKey:t}},x=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e&&t&&r.some(e=>e.address===n.dN)?[{transactionHash:"0xd4547dc336dd4a0655f11267537964d7641f115ef3d5440d71514e3efba9d210",blockNumber:14591056,transactionIndex:145,logIndex:0,address:n.dN,topics:[(0,s.e)("ApprovalForAll(address,address,bool)"),(0,l.p1)(e),(0,l.p1)(t)],data:"0x1",timestamp:1649997510}]:[]},C=e=>{let{contract:t,metadata:r,chainId:n,owner:a,balance:o}=e;return{contract:t,metadata:r,chainId:n,owner:a,balance:o}},B=e=>"".concat(e.contract.address,"-").concat(e.spender,"-").concat(e.tokenId,"-").concat(e.chainId,"-").concat(e.owner),N=(e,t)=>{var r,n;return"0"===k(e.amount,null==t?void 0:null===(r=t.metadata)||void 0===r?void 0:r.decimals,null==t?void 0:null===(n=t.metadata)||void 0===n?void 0:n.totalSupply)},I=async e=>{try{let t=await o.Z.post("https://api-scan-wallet.nefture.com/getScore",{json:{address:e}}).json();if("pending"===t.status)return await (0,l.gw)(5e3),I(e);if("success"!==t.status)throw Error("Nefture API error");return t.score}catch(r){var t;if((null==r?void 0:null===(t=r.response)||void 0===t?void 0:t.status)===500)return await (0,l.gw)(5e3),I(e);throw r}}},6481:function(e,t,r){"use strict";r.d(t,{O1:function(){return l},WW:function(){return a},eE:function(){return s},mw:function(){return o},nI:function(){return i}});var n=r(30040);let a=e=>{let t=null==e?void 0:e.toLowerCase();return!!((null==t?void 0:t.includes("user denied"))||(null==t?void 0:t.includes("user rejected"))||(null==t?void 0:t.includes("transaction was rejected")))},o=e=>{let t=null==e?void 0:e.toLowerCase();return null!=t&&!!t.includes("revert")},i=e=>{let t=null==e?void 0:e.toLowerCase();return!!((null==t?void 0:t.includes("query returned more than 10000 results"))||(null==t?void 0:t.includes("log response size exceeded"))||(null==t?void 0:t.includes("query timeout exceeded"))||(null==t?void 0:t.includes("queued request timed out")))},s=e=>{let t=null==e?void 0:e.toLowerCase();return!!((null==t?void 0:t.includes("request failed"))||(null==t?void 0:t.includes("request timed out"))||(null==t?void 0:t.includes("request took too long to respond"))||(null==t?void 0:t.includes("failed to fetch")))},l=e=>{var t,r,a,o;let i=(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.message)||(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)||(null==e?void 0:e.details)||(null==e?void 0:e.shortMessage)||(null==e?void 0:e.message)||e;if("object"==typeof i)try{return(0,n.P)(i)}catch(e){}return String(i)}},41819:function(e,t,r){"use strict";r.d(t,{Ld:function(){return l},VJ:function(){return c},bY:function(){return d}});var n=r(26294),a=r(7930),o=r(23894),i=r(66685),s=r(96815);let l="0x000000000022D473030F116dDEE9F6B43aC78BA3",c=async(e,t,r)=>{let n=(0,i.O1)(r).reverse(),a=(0,i.Fv)(n,[1,2,3]);return await Promise.all(a.map(r=>u(e,t,r)))},u=async(e,t,r)=>{let i=(0,o.F)({abi:n.f4,...r}),{spender:c,amount:u,expiration:d}=i.args;if("Lockdown"===i.eventName||0n===u||d*s.sh<=Date.now())return{spender:c,amount:0n,lastUpdated:0,transactionHash:r.transactionHash};let[m,v,p]=await Promise.all([e.publicClient.readContract({address:l,abi:n.f4,functionName:"allowance",args:[t,e.address,c]}),a.Z.getLogTimestamp(e.publicClient,r),r.transactionHash]),[f]=m;return{spender:c,amount:f,lastUpdated:v,transactionHash:p,expiration:d}},d=async(e,t,r,a,o)=>e.writeContract({address:l,abi:n.f4,functionName:"approve",args:[t.address,r,a,o],account:await (0,i.Tu)(e),chain:e.chain,value:0n})},42480:function(){}}]);